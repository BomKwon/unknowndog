<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/layout1}">
<head>
    <meta charset="UTF-8">
    <title>Î™®Î•¥Îäî Í∞ú ÏÇ∞Ï±Ö :: Í∞ÄÏûÖÌïòÍ∞ú</title>


    <th:block layout:fragment="css">
        <!--css-->
        <style>
            .fieldError {
                color: red;
            }
        </style>
    </th:block>

    <!-- ÏÇ¨Ïö©Ïûê Ïä§ÌÅ¨Î¶ΩÌä∏ Ï∂îÍ∞Ä-->
    <th:block layout:fragment="script">
        <script th:inline="javascript">

            $(document).ready(function errMsg() {

                var errorMessage = [[${errorMessage}]]
                if(errorMessage != null){
                    alert(errorMessage);
                }



                $("#emailChk").hide()
                $("#nNameChk").hide()


                var name = $("#name").val()
                var password = $("#password").val()
                var pw2 = $("#password2").val()
                var address = $("#address").val()




                //ÏûÖÎ†•ÌñàÎäîÏßÄ ÏïàÌñàÎäîÏßÄ Î≥¥Îäî Í≤ÄÏÇ¨

                // $("#name").focusout()(function () {
                //     if (name == '' || name.length == 0) {
                //         alert("Ïù¥Î¶ÑÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÍ∞ú")
                //         return false
                //     }
                // })
                //
                //
                // $("#password").focusout()(function () {
                //
                //     if (password == '' || password.length == 0 ) {
                //         alert("ÎπÑÎ∞ÄÎ≤àÌò∏Î•º ÏûÖÎ†•Ìï¥Ï£ºÍ∞ú")
                //         return false
                //     } else if (16 < password.length < 8) {
                //         $("#label3").css("color", "lightcoral")
                //             .text("ÎπÑÎ∞ÄÎ≤àÌò∏Îäî 8Ïûê Ïù¥ÏÉÅ, 16Ïûê Ïù¥ÌïòÎ°ú ÏûÖÎ†•Ìï¥Ï£ºÍ∞ú");
                //         return false
                //     }
                // })

                //ÎπÑÎ∞ÄÎ≤àÌò∏ ÌôïÏù∏
                // $("#password2").focusout(function() {
                //
                //     var param1 = {
                //         password : password,
                //         password2 : pw2
                //     }
                //
                //     //AjaxÎ°ú Ï†ÑÏÜ°
                //     $.ajax({
                //         url: '/user/passwordChk',
                //         data: param1,
                //         type: 'POST',
                //         dataType: 'text',
                //         success: function (result) {
                //             console.log(result)
                //             $("#label3").css("color", "lightblue").text(result);
                //         },
                //         error : function (error) {
                //             alert("ÎπÑÎ∞ÄÎ≤àÌò∏ ÌôïÏù∏ ÏóêÎü¨Î∞úÏÉù! " + error)
                //         }
                //     })
                //
                // })





                // $("#address").focusout()(function () {
                //     if (address == '', address.length == 0) {
                //         alert("Ï£ºÏÜåÎ•º ÏûÖÎ†•Ìï¥Ï£ºÍ∞ú")
                //         return false
                //     }
                // })









                //     Ïù¥Î©îÏùº Ï§ëÎ≥µÏ≤¥ÌÅ¨
                $("#email").focusout(function() {


                    console.log("Ïù¥Î©îÏùº Ïú†Ìö®ÏÑ±Í≤ÄÏÇ¨")

                    var email = $("#email").val()

                    var param = {
                        email : email
                    }

                    //ÏûÖÎ†•ÌñàÎäîÏßÄ ÏïàÌñàÎäîÏßÄ Î≥¥Îäî Í≤ÄÏÇ¨
                    if (email == '' || email.length == 0) {
                        $("#label1").css("color", "lightcoral").text("Ïù¥Î©îÏùºÏùÑ ÏûÖÎ†•ÌïòÍ∞ú!!!!");
                        return false;
                    }

                    // Ïù¥Î©îÏùº Ïú†Ìö®ÏÑ±Í≤ÄÏÇ¨
                        email_regex = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/i;

                        if (!email_regex.test(email)) {
                            $("#label1").css("color", "lightcoral").text("Ïú†Ìö®ÌïòÏßÄ ÏïäÏùÄ Ïù¥Î©îÏùº Ï£ºÏÜåÎã§Í∞ú");
                            $("#emailChk").hide()
                            return false;
                        } else if (email_regex.test(email)) {

                            $("#emailChk").show()
                            $("#label1").css("color", "lightblue").text("Ïú†Ìö®Ìïú Ïù¥Î©îÏùº Ï£ºÏÜåÎã§Í∞ú");
                            $("#emailChk").on("click" , function () {

                                //AjaxÎ°ú Ï†ÑÏÜ°
                                $.ajax({
                                    url: '/user/duplicateE',
                                    data: param,
                                    type: 'POST',
                                    dataType: 'text',
                                    success: function (result) {
                                        console.log(result)
                                        $("#label1").css("color", "lightblue").text(result);
                                    },
                                    error : function (error) {
                                        alert("Ïù¥Î©îÏùº Ï§ëÎ≥µÌôïÏù∏ ÏóêÎü¨Î∞úÏÉù! " + error)
                                    }
                                })//End Ajax

                            })//end emailChkBtn function

                        }// end else if


                })//end focusout function


                //     Î≥ÑÎ™Ö Ï§ëÎ≥µÏ≤¥ÌÅ¨
                $("#nickname").focusout(function() {


                    console.log("Î≥ÑÎ™Ö Ïú†Ìö®ÏÑ±Í≤ÄÏÇ¨")

                    var nickname = $("#nickname").val()

                    var param = {
                        nickname : nickname
                    }

                    //ÏûÖÎ†•ÌñàÎäîÏßÄ ÏïàÌñàÎäîÏßÄ Î≥¥Îäî Í≤ÄÏÇ¨
                    if (nickname == '' || nickname.length == 0) {
                        $("#label2").css("color", "lightcoral").text("Î≥ÑÎ™ÖÏùÑ ÏûÖÎ†•ÌïòÍ∞ú!!!!");
                        return false;
                    }


                    $("#nNameChk").show()

                    $("#nNameChk").on("click" , function () {

                            //AjaxÎ°ú Ï†ÑÏÜ°
                            $.ajax({
                                url: '/user/duplicateN',
                                data: param,
                                type: 'POST',
                                dataType: 'text',
                                success: function (result) {
                                    console.log(result)
                                    $("#label2").css("color", "lightblue").text(result);
                                },
                                error : function (error) {
                                    alert("Î≥ÑÎ™Ö Ï§ëÎ≥µÌôïÏù∏ ÏóêÎü¨Î∞úÏÉù! " + error)
                                }
                            })//End Ajax

                    })//end nNameChkBtn function

                })//end focusout function






                $(".regiBtn").on("click", function () {



                })



            });




        </script>


    </th:block>


</head>
<body>


<div layout:fragment="content">

    <div class="col">
        <div class="card border-light shadow">

            <div class="card-body">

                <h4>üê£ Í∞ÄÏûÖÌïòÍ∞ú</h4>

                <hr>

                <div class="row row-cols-1  row-cols-md-1">
                    <div class="col">

                            <div class="card-body">



                                <form action="/user/register" method="post" th:object="${userFormDTO}" >
                                    <!-- th:objectÎäî th:field=*{ÌïÑÎìúÍ∞í}-->

                                    <!-- Ïù¥Î¶Ñ-->
                                    <div class="row g-5 align-items-center">
                                        <div class="col-auto">
                                            <label for="name" class="form-label">Ïù¥  Î¶Ñ</label>
                                        </div>

                                        <div class="col-auto">
                                            <input type="text" class="form-control" th:field="*{name}" > <!--placeholder="Ïù¥Î¶ÑÏùÑ ÏûÖÎ†•ÌïòÎùºÍ∞ú"-->
                                        </div>

                                        <div class="col-auto">
                                            <span id="nameHelpInline" class="form-text">
                                                <p th:if="${#fields.hasErrors('name')}"    th:errors="*{name}" class="fieldError" ></p>
                                            </span>
                                        </div>

                                    </div>

                                    <br>


                                    <!-- Ïù¥Î©îÏùº-->
                                    <div class="row g-4 align-items-center">
                                        <div class="col-auto">
                                            <label for="email" class="form-label">Ïù¥ Î©î Ïùº</label>
                                        </div>

                                        <div class="col-auto" style="display:inline;">
                                            <input type="email" class="form-control" th:field="*{email}" ><!--placeholder="Ïù¥Î©îÏùºÏùÑ ÏûÖÎ†•ÌïòÎùºÍ∞ú">-->
                                        </div>


                                        <div class="col-auto">
                                            <button type="button" value="dupCheckE" id="emailChk" class="btn btn-light text-nowrap"  style="background-color: honeydew; --bs-btn-padding-y: .25rem; --bs-btn-padding-x: .5rem; --bs-btn-font-size: .75rem;">Ï§ëÎ≥µÌôïÏù∏</button>
                                        </div>

                                        <div class="col-auto">
                                            <label id="label1"></label>
                                        </div>

                                        <span id="emailHelpInline" class="form-text">
                                            <p th:if="${#fields.hasErrors('email')}"    th:errors="*{email}" class="fieldError" ></p>
                                        </span>

                                    </div>

                                    <br>


                                    <!-- ÎπÑÎ∞ÄÎ≤àÌò∏-->
                                    <div class="row g-4 align-items-center">
                                        <div class="col-auto">
                                        <label for="password" class="form-label">ÎπÑÎ∞ÄÎ≤àÌò∏</label>
                                        </div>

                                        <div class="col-auto">
                                        <input type="text" class="form-control"  th:field="*{password}" ><!--placeholder="ÎπÑÎ∞ÄÎ≤àÌò∏Î•º ÏûÖÎ†•ÌïòÎùºÍ∞ú">-->
                                        </div>

                                        <div class="col-auto">
                                            <label for="password2" class="form-label">ÎπÑÎ∞ÄÎ≤àÌò∏ ÌôïÏù∏</label>
                                        </div>

                                        <div class="col-auto">
                                            <input type="text" class="form-control"  th:field="*{password2}" ><!--placeholder="ÎπÑÎ∞ÄÎ≤àÌò∏Î•º ÏûÖÎ†•ÌïòÎùºÍ∞ú">-->
                                        </div>

                                        <div class="col-auto">
                                            <label id="label3"></label>
                                        </div>

                                        <div class="col-auto">
                                            <span id="passwordHelpInline" class="form-text">
                                                <p th:if="${#fields.hasErrors('password')}"    th:errors="*{password}" class="fieldError" ></p>
                                            </span>
                                        </div>
                                    </div>


                                    <br>


                                    <!-- ÎãâÎÑ§ÏûÑ-->
                                    <div class="row g-5 align-items-center">
                                        <div class="col-auto">
                                            <label for="nickname" class="form-label">Î≥Ñ  Î™Ö</label>
                                        </div>

                                        <div class="col-auto">
                                            <input type="text" class="form-control" th:field="*{nickname}" ><!--placeholder="Î≥ÑÎ™ÖÏùÑ ÏûÖÎ†•ÌïòÎùºÍ∞ú">-->
                                        </div>

                                        <div class="col-auto">
                                            <button type="button" value="dupCheckN" id="nNameChk" class="btn btn-light"  style="background-color: honeydew; --bs-btn-padding-y: .25rem; --bs-btn-padding-x: .5rem; --bs-btn-font-size: .75rem;">Ï§ëÎ≥µÌôïÏù∏</button>
                                        </div>

                                        <div class="col-auto">
                                            <label id="label2"></label>
                                        </div>

                                        <span id="nicknameHelpInline" class="form-text">
                                            <p th:if="${#fields.hasErrors('nickname')}"    th:errors="*{nickname}" class="fieldError" ></p>
                                        </span>

                                    </div>





                                    <br>


                                    <div class="row g-4 align-items-center">
                                        <div class="col-auto">
                                            <label for="birth" class="form-label">ÏÉùÎÖÑÏõîÏùº</label>
                                        </div>
                                        <div class="col-auto">
                                            <input type="date" class="form-control" th:field="*{birth}" ><!--placeholder="Ï£ºÏÜåÎ•º ÏûÖÎ†•ÌïòÎùºÍ∞ú">-->
                                        </div>

                                        <div class="col-auto">
                                            <span id="birthHelpInline" class="form-text">
                                                <p th:if="${#fields.hasErrors('birth')}"    th:errors="*{birth}" class="fieldError" ></p>
                                            </span>
                                        </div>

                                    </div>



                                    <br>



                                    <!-- Ï£ºÏÜå Ï∂îÌõÑ ÏÖÄÎ†âÌä∏ Î∞ïÏä§Î°ú Î∞îÍøÄ Í≤É -->
                                    <div class="row g-5 align-items-center">
                                        <div class="col-auto">
                                            <label for="address" class="form-label">Ï£º  ÏÜå</label>
                                        </div>
                                        <div class="col-auto">
                                            <input type="text" class="form-control" th:field="*{address}" ><!--placeholder="Ï£ºÏÜåÎ•º ÏûÖÎ†•ÌïòÎùºÍ∞ú">-->
                                        </div>

                                        <div class="col-auto">
                                            <span id="addHelpInline" class="form-text">
                                                ÎèôÍπåÏßÄ ÏûÖÎ†•Ìï¥Ï£ºÏãúÍ∞ú
                                                <p th:if="${#fields.hasErrors('address')}"    th:errors="*{address}" class="fieldError" ></p>
                                            </span>
                                        </div>

                                    </div>

                                    <div style="text-align: center">
                                        <button type="submit" value="submit" class="btn btn-danger regiBtn">ÌöåÏõêÍ∞ÄÏûÖ</button>
                                    </div>


                                    <div th:unless="${#strings.isEmpty(userFormDTO.id)}">
                                        <button th:formaction="@{'/quest/modify/' + ${questFormDTO.id}  }" type="submit" class="btn btn-light btn-sm modBtn">ÏàòÏ†ï</button>
                                        <a th:href="@{'/quest/remove/' + ${questId} }" class="btn btn-danger btn-sm delBtn">
                                            ÏÇ≠Ï†ú
                                        </a>
                                    </div>

                                </form>

                            </div>


                    </div>

                </div>

            </div>

        </div>

    </div>





</div>

</body>
</html>